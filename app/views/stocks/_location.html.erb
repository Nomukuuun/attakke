<div class="bg-white pb-4 mb-10 rounded shadow-sm">

  <!-- 保管場所のヘッダー：一覧画面でのみ保管場所名の編集、ストック追加可能 -->
  <div class="location-header sticky z-5 top-40 md:top-44 bg-white px-4 py-3 mb-1">
    <div class="h-8 flex justify-between items-center">

      <%# NOTE: ストック一覧画面 かつ ソートモードがオフのときのみ保管場所名の変更とストックの追加を許可する %>
      <% if (current_list_type_value || list_type) == "all" && (current_sort_mode_value || sort_mode) == "off" %>

        <%= link_to edit_location_path(location), data: { turbo_frame: 'modal_frame' }, class: "flex items-center pl-4" do %>
          <h2 class="text-xl md:text-2xl text-f-head font-bold"><%= location.name %></h2>
        <% end %>

        <%= link_to new_stock_path(location_id: location.id), data: { turbo_frame: 'modal_frame' }, class: "flex item-center pr-4" do %>
          <svg class="size-8 text-dull-red" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"/>
          </svg>
        <% end %>

      <% else %>

        <h2 class="flex items-center text-xl md:text-2xl disabled-text-color font-bold pl-4"><%= location.name %></h2>
      <% end %>
    </div>
  </div>

  <!-- ストックリスト -->
  <%# NOTE: idはbroadcast.prependによるストック追加範囲特定、stocks_listはソートグループ特定用に設置 %>
  <div data-controller="sortable" data-sortable-location-id-value="<%= location.id %>" id="location_<%= location.id %>_stocks_list" class="stocks_list md:grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 md:gap-4 px-4">
    <% if stocks&.find_by(location_id: location.id).present? %>

      <% stocks.where(location_id: location.id).each do |stock| %>
        <%= turbo_frame_tag stock, data: { sortable_stock_id_value: stock.id } do %>
          <%= render 'stocks/stock', stock: stock, sort_mode: (current_sort_mode_value || sort_mode) %>
        <% end %>
      <% end %>

    <% else %>
      <p class="text-lg md:text-xl disabled-text-color pl-6">表示するストックがありません</p>
    <% end %>
  </div>
</div>
